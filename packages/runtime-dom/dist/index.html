<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div id="app"></div>

    <script type="module">
        import {
            // createRenderer,
            // render,
            // h,
            // ref,
            // onBeforeMount,
            // onMounted,
            // onBeforeUpdate,
            // onUpdated,
        } from '/node_modules/@vue/runtime-dom/dist/runtime-dom.esm-browser.js';

        import {
            rendererOptions,
            render,
            h,
            Text,
            Fragment,
            ref,
            onBeforeMount,
            onMounted,
            onBeforeUpdate,
            onUpdated,
            onBeforeUnmount,
            onUnmounted,
            getCurrentInstance,
        } from './runtime-dom.js';

        // 生命周期钩子
        // child setup
        // child before mount
        // child mounted
        // parent mounted
        // parent before update
        // child before update
        // child updated
        // parent updated
        // parent before unmount
        // child before unmount
        // child unmounted
        // parent unmounted
        const RenderComponent = {
            props: {
                name: String
            },
            setup(props, { emit, slots, expose, attrs }) {
                console.log('child setup');
                console.log(getCurrentInstance());
                onBeforeMount(() => {
                    console.warn('child bug: ', getCurrentInstance()); // 此处能拿到当前组件实例的原因见apiLifecycle#createHook注释
                    console.log('child before mount');
                });
                onMounted(() => {
                    console.log('child mounted');
                });
                onBeforeUpdate(() => {
                    console.log('child before update');
                });
                onUpdated(() => {
                    console.log('child updated');
                });
                onBeforeUnmount(() => {
                    console.log('child before unmount');
                });
                onUnmounted(() => {
                    console.log('child unmounted');
                });
                return () => {
                    return h('div', 'Hello ' + props.name);
                }
            }
        };
        const VueComponent = {
            setup(props, { emit, expose, slots, attrs }) {
                console.log('parent setup');
                console.log(getCurrentInstance());
                onBeforeMount(() => {
                    console.log('parent before mount');
                });
                onMounted(() => {
                    console.log('parent mounted');
                });
                onBeforeUpdate(() => {
                    console.log('parent before update');
                });
                onUpdated(() => {
                    console.log('parent updated');
                });
                onBeforeUnmount(() => {
                    console.log('parent before unmount');
                });
                onUnmounted(() => {
                    console.log('parent unmounted');
                });
                const name = ref('Bilibili!');
                setTimeout(() => {
                    name.value = 'Vue!'
                }, 1000);
                return () => {
                    return h(RenderComponent, {
                        name: name.value
                    });
                }
            }
        }
        render(h(VueComponent), app);
        setTimeout(() => {
            render(h(null), app);
        }, 2000);


    </script>
</body>

</html>